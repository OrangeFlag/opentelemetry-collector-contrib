name: postgresqlreceiver

resource_attributes:
  postgresql.database:
    description: The name of the database being monitored
    type: string
  postgresql.database.table:
    description: The schema name followed by the table name.
    type: string
  postgresql.index.name:
    description: The name of the index.
    type: string
  postgresql.query:
    description: The SQL query text of the query.
    type: string

attributes:
  bg_buffer_source:
    description: The source of a buffer write.
    enum:
      - backend
      - backend_fsync
      - checkpoints
      - bgwriter
    value: source
  bg_checkpoint_type:
    description: The type of checkpoint state
    enum:
      - requested
      - scheduled
    value: type
  bg_duration_type:
    description: The type of time spent during the checkpoint.
    enum:
      - sync
      - write
    value: type
  database:
    description: The name of the database being monitored
    type: string
  operation:
    description: The database operation.
    enum:
      - ins
      - upd
      - del
      - hot_upd
  query_block_operation:
    description: The operation the query performed on the block.
    enum:
      - dirty
      - read
      - write
    value: operation
  query_block_type:
    description: The type of block utilized by the query.
    enum:
      - local
      - shared
      - temp
    value: block
  source:
    description: The block read source type.
    enum:
      - heap_read
      - heap_hit
      - idx_read
      - idx_hit
      - toast_read
      - toast_hit
      - tidx_read
      - tidx_hit
  state:
    description: The tuple (row) state.
    enum:
      - dead
      - live
  table:
    description: The schema name followed by the table name.
    type: string
  transaction_result:
    value: result
    description: The result of a transaction
    type: string
    enum:
      - rollback
      - committed
  wal_operation_lag:
    value: operation
    description: The operation which responsible for the lag.
    type: string
    enum:
      - flush
      - replay
      - write

metrics:
  postgresql.backends:
    attributes:
      - database
    description: The number of backends.
    enabled: true
    sum:
      aggregation: cumulative
      monotonic: false
      value_type: int
    unit: 1
  postgresql.bgwriter.buffers.allocated:
    description: Number of buffers allocated
    enabled: true
    sum:
      aggregation: cumulative
      monotonic: true
      value_type: int
    unit: "{buffers}"
  postgresql.bgwriter.buffers.writes:
    attributes:
      - bg_buffer_source
    description: Number of buffers written
    enabled: true
    sum:
      aggregation: cumulative
      monotonic: true
      value_type: int
    unit: "{buffers}"
  postgresql.bgwriter.checkpoint.count:
    attributes:
      - bg_checkpoint_type
    description: The number of checkpoints performed
    enabled: true
    sum:
      aggregation: cumulative
      monotonic: true
      value_type: int
    unit: "{checkpoints}"
  postgresql.bgwriter.duration:
    attributes:
      - bg_duration_type
    description: Total time spent writing and syncing files to disk by checkpoints.
    enabled: true
    sum:
      aggregation: cumulative
      monotonic: true
      value_type: int
    unit: ms
  postgresql.bgwriter.maxwritten.count:
    description: Number of times the background writer stopped a cleaning scan because it had written too many buffers.
    enabled: true
    sum:
      aggregation: cumulative
      monotonic: true
      value_type: int
  postgresql.block.count:
    description: Total number of blocks
    enabled: true
    sum:
      aggregation: cumulative
      monotonic: false
      value_type: int
    unit: "{blocks}"
  postgresql.blocks_read:
    attributes:
      - database
      - table
      - source
    description: The number of blocks read.
    enabled: true
    sum:
      aggregation: cumulative
      monotonic: true
      value_type: int
    unit: 1
  postgresql.commits:
    attributes:
      - database
    description: The number of commits.
    enabled: true
    sum:
      aggregation: cumulative
      monotonic: true
      value_type: int
    unit: 1
  postgresql.index.scans:
    description: The number of index scans on a table.
    enabled: true
    sum:
      aggregation: cumulative
      monotonic: false
      value_type: int
    unit: "{scans}"
  postgresql.index.size:
    description: Size of the index on disk.
    enabled: true
    gauge:
      value_type: int
    unit: By
  postgresql.database.transactions:
    attributes: [transaction_result]
    description: Number of transactions rolled back or committed.
    enabled: true
    sum:
      aggregation: cumulative
      monotonic: true
      value_type: int
    unit: "{transactions}"
  postgresql.db_size:
    attributes:
      - database
    description: The database disk usage.
    enabled: true
    sum:
      aggregation: cumulative
      monotonic: false
      value_type: int
    unit: By
  postgresql.table.size:
    attributes:
      - database
      - table
    description: Disk space used by a table.
    enabled: true
    unit: By
    gauge:
      value_type: int
  postgresql.operations:
    attributes:
      - database
      - table
      - operation
    description: The number of db row operations.
    enabled: true
    sum:
      aggregation: cumulative
      monotonic: true
      value_type: int
    unit: 1
  postgresql.query.block.count:
    attributes:
      - query_block_operation
      - query_block_type
    description: Total number of blocks dirtied, read, or written by queries.
    enabled: true
    sum:
      aggregation: cumulative
      monotonic: true
      value_type: int
    unit: "{queries}"
  postgresql.query.count:
    attributes: []
    description: Number of queries executed.
    enabled: true
    sum:
      aggregation: cumulative
      monotonic: true
      value_type: int
    unit: "{queries}"
  postgresql.query.duration.average:
    attributes: []
    description: Average time spent executing a query.
    enabled: true
    gauge:
      value_type: double
    unit: ms
  postgresql.query.duration.total:
    attributes: []
    description: Total time spent executing a query.
    enabled: true
    sum:
      aggregation: cumulative
      monotonic: true
      value_type: double
    unit: ms
  postgresql.replication.delay:
    attributes: []
    description: The amount of time of lag between the current clock and the timestamp of the last WAL record.
    enabled: true
    gauge:
      value_type: int
    unit: ms
  postgresql.replication.data_delay:
    attributes: []
    description: The amount of data delayed in replication.
    enabled: true
    gauge:
      value_type: int
    unit: By
  postgresql.rollbacks:
    attributes:
      - database
    description: The number of rollbacks.
    enabled: true
    sum:
      aggregation: cumulative
      monotonic: true
      value_type: int
    unit: 1
  postgresql.rows:
    attributes:
      - state
      - database
      - table
    description: The number of rows in the database.
    enabled: true
    sum:
      aggregation: cumulative
      monotonic: false
      value_type: int
    unit: 1
  postgresql.table.count:
    attributes:
      - database
    description: Number of user tables in a database.
    enabled: true
    gauge:
      value_type: int
  postgresql.table.vacuum.count:
    attributes:
      - database
      - table
    description: Number of times a table has manually been vacuumed.
    enabled: true
    sum:
      aggregation: cumulative
      monotonic: false
      value_type: int
  postgresql.wal.age:
    attributes: []
    description: Age of the oldest WAL file.
    enabled: true
    gauge:
      value_type: int
  postgresql.wal.lag:
    attributes: [wal_operation_lag]
    description: Time between flushing recent WAL locally and receiving notification that this standby server has completed an operation with it.
    enabled: true
    gauge:
      value_type: int
